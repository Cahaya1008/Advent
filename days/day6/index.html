<!doctype html>
<html lang="en">
<head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Day 6 — Maze</title>
<style>
  body{margin:0;font-family:Inter,Arial;background:linear-gradient(180deg,#041226,#072238);color:#fff;padding:12px}
  .wrap{max-width:1100px;margin:0 auto}
  h2{margin:0}
  .mazeWrap{background:#fff;padding:10px;border-radius:8px;margin-top:12px;overflow:auto}
  .cell{width:12px;height:12px;display:inline-block;box-sizing:border-box;border:1px solid #ddd}
  .controls{margin-top:12px}
  button{background:#ffd98a;border:0;padding:8px 12px;border-radius:8px;color:#072;font-weight:800}
  .muted{color:#7f9fc2}
  .found{margin-top:12px;background:#fff;color:#072;padding:10px;border-radius:8px;display:flex;justify-content:space-between;align-items:center}
</style>
</head>
<body>
  <div class="wrap">
    <h2>Day 6 — Maze (very wide & complex)</h2>
    <p class="muted">Click inside the maze and use arrow keys to move the red avatar to the green box. Movement speed increased.</p>

    <div class="mazeWrap" id="mazeWrap"></div>
    <div class="controls"><button id="regen">Regenerate</button> <button id="closeBtn">Close</button></div>

    <div id="foundPanel" style="display:none" class="found"><div>Letter found: <strong id="foundLetter">N</strong></div><div><button id="closeFound">Close</button></div></div>
  </div>

<script>
/* Day 6 Maze */
const DAY = 6;
const COLLECT_LETTER = 'N';
const wrap = document.getElementById('mazeWrap');
const rows = 41, cols = 61; // wide maze
let grid = Array.from({length:rows}, ()=>Array(cols).fill(1));
function carve(r,c){
  const dirs = [[-2,0],[2,0],[0,-2],[0,2]].sort(()=>Math.random()-0.5);
  grid[r][c] = 0;
  for(const [dr,dc] of dirs){
    const nr=r+dr, nc=c+dc;
    if(nr<=0||nr>=rows-1||nc<=0||nc>=cols-1) continue;
    if(grid[nr][nc]===1){
      grid[r+dr/2][c+dc/2] = 0;
      carve(nr,nc);
    }
  }
}
let pr=1, pc=1, gr=rows-2, gc=cols-2;
function gen(){
  grid = Array.from({length:rows}, ()=>Array(cols).fill(1));
  carve(1,1);
  pr=1; pc=1;
  gr=rows-2; gc=cols-2;
  render();
}
function render(){
  wrap.innerHTML='';
  const m = document.createElement('div'); m.style.lineHeight='0';
  for(let r=0;r<rows;r++){
    for(let c=0;c<cols;c++){
      const cell = document.createElement('div'); cell.className='cell';
      if(r===pr && c===pc) cell.style.background='red';
      else if(r===gr && c===gc) cell.style.background='lightgreen';
      else cell.style.background = grid[r][c]===1 ? '#111' : '#fff';
      m.appendChild(cell);
    }
    const br = document.createElement('div'); br.style.clear='both'; m.appendChild(br);
  }
  wrap.appendChild(m);
  m.tabIndex=0; m.focus();
  m.onkeydown = (e)=>{ if(['ArrowUp','ArrowDown','ArrowLeft','ArrowRight'].includes(e.key)){ e.preventDefault(); const map={'ArrowUp':[-1,0],'ArrowDown':[1,0],'ArrowLeft':[0,-1],'ArrowRight':[0,1]}; const [dr,dc]=map[e.key]; move(dr,dc); } };
}
function move(dr,dc){
  const nr = pr+dr, nc = pc+dc;
  if(nr<0||nr>=rows||nc<0||nc>=cols) return;
  if(grid[nr][nc]===1) return;
  pr=nr; pc=nc; render();
  if(pr===gr && pc===gc){
    try{ if(window.parent && window.parent.collectLetterFromDay) window.parent.collectLetterFromDay(DAY, COLLECT_LETTER); else window.parent.postMessage({type:'collected', day:DAY, value:COLLECT_LETTER}, '*'); }catch(e){ window.parent.postMessage({type:'collected', day:DAY, value:COLLECT_LETTER}, '*'); }
    document.getElementById('foundLetter').textContent = COLLECT_LETTER;
    document.getElementById('foundPanel').style.display = 'flex';
  }
}
document.getElementById('regen').addEventListener('click', gen);
document.getElementById('closeBtn').addEventListener('click', ()=>{ try{ window.parent.hideModal(); }catch(e){ window.parent.postMessage({type:'requestClose'}, '*'); } });
document.getElementById('closeFound').addEventListener('click', ()=>{ try{ window.parent.hideModal(); }catch(e){ window.parent.postMessage({type:'requestClose'}, '*'); } });

gen();
</script>
</body>
</html>
