<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Day 1 — Wordle</title>
<style>
  :root{ --bg:#071427; --card:#fff; --accent:#ffd98a; }
  body{margin:0;font-family:Inter,system-ui,Arial;background:linear-gradient(180deg,#041226,#072238);color:#fff;padding:14px;}
  .wrap{max-width:760px;margin:0 auto;background:rgba(255,255,255,0.02);padding:16px;border-radius:10px}
  h2{margin:0 0 8px 0}
  #rows{display:flex;flex-direction:column;gap:8px;margin:12px 0}
  .row{display:flex;gap:8px}
  .cell{width:56px;height:56px;border-radius:8px;background:#fff;color:#072;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:20px}
  .cell.gray{background:#e6e6e6}
  .cell.yellow{background:#ffd56b}
  .cell.green{background:#7cf}
  input[type="text"]{padding:10px;border-radius:8px;border:0;width:260px}
  button{padding:8px 12px;border-radius:8px;border:0;background:var(--accent);color:#072;font-weight:800;cursor:pointer}
  .muted{color:#b8cee4}
  .hint{margin-top:12px;background:rgba(255,255,255,0.02);padding:10px;border-radius:8px}
  .foundBox{margin-top:12px;background:#fff;padding:10px;border-radius:8px;color:#072;font-weight:900;display:flex;align-items:center;justify-content:space-between}
</style>
</head>
<body>
  <div class="wrap">
    <h2>Day 1 — Wordle (5 letters)</h2>
    <p class="muted">Guess the 5-letter English word. When you guess correctly, the hint appears and you must click the secret letter in the solved word to store it.</p>

    <div id="rows"></div>

    <div>
      <input id="guess" maxlength="5" placeholder="Type a 5-letter word" />
      <button id="try">Try</button>
      <button id="closeBtn" style="margin-left:8px">Close</button>
    </div>

    <div id="hintArea" class="hint muted" style="display:none"></div>

    <div id="foundPanel" style="display:none" class="foundBox">
      <div>Letter found: <span id="foundLetter" style="font-size:18px"></span></div>
      <div><button id="foundClose">Close</button></div>
    </div>
  </div>

<script>
/* Day 1 Wordle */
const DAY = 1;
const COLLECT_LETTER = 'R';
const TARGET = 'THORN';

/* tiny dictionary — extend this array with a larger one or fetch an external wordlist */
const DICT = ['THORN','THOSE','THEIR','SPARE','CRANE','BROOM','APPLE','GLASS','HEART','LIGHT','BRAVE','BRING','PLACE','STONE','BLADE','PRIDE','QUICK','SPOON','HOUSE'];

const rowsEl = document.getElementById('rows');
const guessEl = document.getElementById('guess');
document.getElementById('try').addEventListener('click', tryGuess);
document.getElementById('closeBtn').addEventListener('click', tryClose);
document.getElementById('foundClose').addEventListener('click', closeAfterCollect);

let rows = [];

function render(){
  rowsEl.innerHTML = '';
  rows.forEach(r=>{
    const node = document.createElement('div'); node.className='row';
    for(let i=0;i<5;i++){
      const ch = document.createElement('div'); ch.className='cell';
      const letter = r[i]||'';
      ch.textContent = letter;
      if(letter){
        // colorize later by state property included in r._colors
        const colors = r._colors || [];
        if(colors[i] === 'green') ch.classList.add('green');
        else if(colors[i] === 'yellow') ch.classList.add('yellow');
        else ch.classList.add('gray');
      }
      node.appendChild(ch);
    }
    rowsEl.appendChild(node);
  });
}

function tryGuess(){
  const g = (guessEl.value||'').trim().toUpperCase();
  if(g.length !== 5){ alert('Please enter 5 letters'); return; }
  if(!DICT.includes(g)){ alert('Word not found in dictionary (replace DICT array with larger list if necessary)'); return; }

  // produce coloring with correct-letter priority: first mark greens, then count remaining target letters for yellows
  const colors = Array(5).fill('gray');
  const targetArr = TARGET.split('');
  // mark greens
  for(let i=0;i<5;i++){
    if(g[i] === TARGET[i]) { colors[i] = 'green'; targetArr[i] = null; }
  }
  // mark yellows
  for(let i=0;i<5;i++){
    if(colors[i] === 'gray'){
      const pos = targetArr.indexOf(g[i]);
      if(pos !== -1){ colors[i] = 'yellow'; targetArr[pos] = null; }
    }
  }
  // push row object
  const row = g.split(''); row._colors = colors;
  rows.push(row);
  render();
  guessEl.value='';

  if(g === TARGET){
    // reveal hint
    document.getElementById('hintArea').style.display = 'block';
    document.getElementById('hintArea').innerHTML = '<strong>Hint revealed:</strong> Heart - heat = ? (click the correct letter in the solved word above to store)';
    // make last row clickable
    const lastRow = rowsEl.lastChild;
    for(let i=0;i<5;i++){
      const cell = lastRow.children[i];
      cell.style.cursor='pointer';
      cell.addEventListener('click', ()=> {
        const clicked = TARGET[i];
        if(clicked === COLLECT_LETTER) collectLetter();
        else alert('That is not the secret letter — try another letter.');
      });
    }
  }
}

function collectLetter(){
  // fallback strategies to notify parent
  try{
    if(window.parent && window.parent.collectLetterFromDay) {
      window.parent.collectLetterFromDay(DAY, COLLECT_LETTER);
    } else {
      window.parent.postMessage({type:'collected', day: DAY, value: COLLECT_LETTER}, '*');
    }
  }catch(e){
    window.parent.postMessage({type:'collected', day: DAY, value: COLLECT_LETTER}, '*');
  }
  // show found panel (closeable)
  document.getElementById('foundLetter').textContent = COLLECT_LETTER;
  document.getElementById('foundPanel').style.display = 'flex';
}

function closeAfterCollect(){
  try{ window.parent.hideModal(); }catch(e){ window.parent.postMessage({type:'requestClose'}, '*'); }
}

function tryClose(){ try{ window.parent.hideModal(); }catch(e){ window.parent.postMessage({type:'requestClose'}, '*'); } }

render();
</script>
</body>
</html>
